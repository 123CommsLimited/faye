<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Faye test suite</title>
  </head>
  <body>

    <script type="text/javascript" src="../node_modules/jstest/jstest.js"></script>
    <script type="text/javascript">
      JS.cache = false

      JS.packages(function() { with(this) {
        file('../build/browser/faye-cov.js').provides('Faye')
        autoload(/.*Spec/, {from: './javascript', require: 'Faye'})
      }})

      var coverage = {
        endSuite: function() {
          var ws = new WebSocket(coverage.url)
          ws.onopen = function() {
            ws.send(JSON.stringify(__coverage__))
            ws.close()
          }
        },
        url: 'ws://localhost:4180/'
      }

      var run = function() {
        JS.Test.autorun(function(runner) {
          runner.addReporter(coverage)
        })
      }

      JS.require( 'FayeSpec',
                  'GrammarSpec',
                  'ChannelSpec',
                  'ClientSpec',
                  'DispatcherSpec',
                  'UriSpec',
                  'TransportSpec',
                  run)
    </script>

  </body>
</html>
